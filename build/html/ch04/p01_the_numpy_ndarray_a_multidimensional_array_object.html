

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4.1 NumPy ndarray：一个多维数组对象 &mdash; pydata 0.1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4.2 通用函数：快速逐元素(element-wise)数组函数" href="p02_Universal_Functions_Fast_Element-Wise_Array_Functions.html" />
    <link rel="prev" title="第四章：numpy基础：数组和向量化计算" href="../chapters/p04_numpy_basics_arrays_and_vectorized_computation.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> pydata
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../chapters/p03_build-in_data_structure_function_and_files.html">第三章：内建数据结构，函数和文件</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../chapters/p04_numpy_basics_arrays_and_vectorized_computation.html">第四章：numpy基础：数组和向量化计算</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">4.1 NumPy ndarray：一个多维数组对象</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ndarray">创建ndarray</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">ndarray数据类型</a></li>
<li class="toctree-l3"><a class="reference internal" href="#numpy-arithmetic">使用NumPy数组进行算术运算(<strong>arithmetic</strong>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">基本索引和切片</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id3">使用切片进行索引</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id4">布尔索引</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fancy-indexing">花式索引(Fancy indexing)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">数组转置和交换轴</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="p02_Universal_Functions_Fast_Element-Wise_Array_Functions.html">4.2 通用函数：快速逐元素(element-wise)数组函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="p03_Array-Oriented_Programming_with_Arrays.html">4.3 使用数组的面向数组编程</a></li>
<li class="toctree-l2"><a class="reference internal" href="p04_File_Input_and_Output_with_Arrays.html">4.4 带数组的文件输入输出</a></li>
<li class="toctree-l2"><a class="reference internal" href="p05_Linear_Algebra.html">4.5 线性代数</a></li>
<li class="toctree-l2"><a class="reference internal" href="p06_Pseudorandom_Number_Generation.html">4.6 伪随机(pseudorandom)数生成</a></li>
<li class="toctree-l2"><a class="reference internal" href="p07_Example_Random_Walks.html">4.7 示例：随机游走</a></li>
<li class="toctree-l2"><a class="reference internal" href="p08_Conclusion.html">4.8 总结</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pydata</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../chapters/p04_numpy_basics_arrays_and_vectorized_computation.html">第四章：numpy基础：数组和向量化计算</a> &raquo;</li>
        
      <li>4.1 NumPy ndarray：一个多维数组对象</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/ch04/p01_the_numpy_ndarray_a_multidimensional_array_object.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="numpy-ndarray">
<h1>4.1 NumPy ndarray：一个多维数组对象<a class="headerlink" href="#numpy-ndarray" title="Permalink to this headline">¶</a></h1>
<p>NumPy最关键的特点之一是它的N维数组对象，或者叫ndarray，在Python中是一个快速、灵活的大数据集容器。
数组使你能够使用相似的语法在整个数据块上执行数学操作，与在标量元素上有相同效果的操作。</p>
<p>为了让您了解NumPy如何使用类似语法对于内置Python对象的标量值启用批量计算，我首先导入NumPy并生成一个小的随机数据数组:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Generate some random data</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.2047</span><span class="p">,</span> <span class="mf">0.4789</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5194</span><span class="p">],</span>
<span class="p">[</span><span class="o">-</span><span class="mf">0.5557</span><span class="p">,</span> <span class="mf">1.9658</span><span class="p">,</span> <span class="mf">1.3934</span><span class="p">]])</span>
</pre></div>
</div>
<p>然后我对数据施加数学操作:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="n">data</span> <span class="o">*</span> <span class="mi">10</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="o">-</span><span class="mf">2.0471</span><span class="p">,</span> <span class="mf">4.7894</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.1944</span><span class="p">],</span>
<span class="p">[</span> <span class="o">-</span><span class="mf">5.5573</span><span class="p">,</span> <span class="mf">19.6578</span><span class="p">,</span> <span class="mf">13.9341</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="n">data</span> <span class="o">+</span> <span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.4094</span><span class="p">,</span> <span class="mf">0.9579</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0389</span><span class="p">],</span>
<span class="p">[</span><span class="o">-</span><span class="mf">1.1115</span><span class="p">,</span> <span class="mf">3.9316</span><span class="p">,</span> <span class="mf">2.7868</span><span class="p">]])</span>
</pre></div>
</div>
<p>在第一个例子中，全部元素都被乘上了10。第二个例子，在数组每个”格子”相应位置值和每个自己相加。</p>
<p>注：
在本章和全书，我使用标准NumPy简写import numpy as np。当然，欢迎放from numpy import *在你的代码中，避免一直写np.，但是我不建议这样的习惯。
numpy名字空间是很大的，包含许多名字和内置Python函数冲突的函数（像min和max）。</p>
<p>ndarray是用于同类(<strong>homogeneous</strong>)数据的通用多维容器;
这是说，所有的元素必须是相同类型。每个数组有一个shape。一个表示每个维度大小的元组，dtype，描述数组数据类型的对象:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>这章讲给你介绍基本的NumPy数组使用，会大量出现于本书的剩余部分。
虽然不必要深入理解NumPy的许多数据分析应用程序，但是精通(<strong>proficient</strong>)面向数组的编程和思考是成为科学计算Python专家(<strong>guru</strong>)的关键一步。</p>
<p>注：
不管在文中你是见到array、NumPy array还是ndarray，除少数例外外，它们都是指相同的东西：ndarray对象。</p>
<div class="section" id="ndarray">
<h2>创建ndarray<a class="headerlink" href="#ndarray" title="Permalink to this headline">¶</a></h2>
<p>创建一个数组的最简单方式是使用array函数。
它接受任何序列对象（包括其它数组），产生一个新的包含传入数据的NumPy数组。举例，列表是转换的好选择:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="n">data1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="n">arr1</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="mf">6.</span> <span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="mf">8.</span> <span class="p">,</span> <span class="mf">0.</span> <span class="p">,</span> <span class="mf">1.</span> <span class="p">])</span>
</pre></div>
</div>
<p>嵌套序列，如等长度列表的列表。将转换成一个多维数组:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="n">data2</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">23</span><span class="p">]:</span> <span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">24</span><span class="p">]:</span> <span class="n">arr2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">24</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span>
</pre></div>
</div>
<p>由于data2是一个列表的列表，因此从数据推断NumPy数组arr2有有两个维度的shape。
我们可以通过检查ndim和shape属性来验证这个:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">25</span><span class="p">]:</span> <span class="n">arr2</span><span class="o">.</span><span class="n">ndim</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">25</span><span class="p">]:</span> <span class="mi">2</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">26</span><span class="p">]:</span> <span class="n">arr2</span><span class="o">.</span><span class="n">shape</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">26</span><span class="p">]:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>除非明确指定，否则np.array尝试为它创建的数组推断一个合适的数据类型。
数据类型是被储存在特殊的元数据对象dtype中；
举例，在之前的两个例子中我们有:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">27</span><span class="p">]:</span> <span class="n">arr1</span><span class="o">.</span><span class="n">dtype</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">27</span><span class="p">]:</span> <span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">28</span><span class="p">]:</span> <span class="n">arr2</span><span class="o">.</span><span class="n">dtype</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">28</span><span class="p">]:</span> <span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>除了np.array还有许多其它函数可以创建新数组。
例如，zeros和ones分别创建全0或全1的数组，使用给定的长度或shape。empty创建没有初始化值到具体值的数组。
为了用这些方法创建更高维度的数组，传一个元组给shape:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">29</span><span class="p">]:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">29</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">30</span><span class="p">]:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">30</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">31</span><span class="p">]:</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">31</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[[</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]],</span>
<span class="p">[[</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]]])</span>
</pre></div>
</div>
<p>注意：
假定np.empty返回一个全0的数组不安全。
在某些情况，它可能返回未初始化的”垃圾”值。</p>
<p>arange是Python内建range函数的一个数组值版本:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">32</span><span class="p">]:</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">32</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">])</span>
</pre></div>
</div>
<p>见表4-1 标准数组创建函数短列表。
由于NumPy关注于数值计算，数据类型如果未指定，在许多情况下是float64（浮点）。</p>
<a class="reference internal image-reference" href="../_images/Table_4-1_Array_creation_functions.png"><img alt="../_images/Table_4-1_Array_creation_functions.png" src="../_images/Table_4-1_Array_creation_functions.png" style="width: 800px;" /></a>
</div>
<div class="section" id="id1">
<h2>ndarray数据类型<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>数据类型或dtype是一类特殊的对象，包含信息（或元数据，关于数据的数据）ndarray需要将一块内存解释为特定的数据类型:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">33</span><span class="p">]:</span> <span class="n">arr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">34</span><span class="p">]:</span> <span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">35</span><span class="p">]:</span> <span class="n">arr1</span><span class="o">.</span><span class="n">dtype</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">35</span><span class="p">]:</span> <span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">36</span><span class="p">]:</span> <span class="n">arr2</span><span class="o">.</span><span class="n">dtype</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">36</span><span class="p">]:</span> <span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>dtype是NumPy与其它系统交互数据的灵活性来源。
在大多数情况下，它们直接映射到底层磁盘或内存表示，可以轻松读取和写入二进制数据流数据到磁盘以及连接到用C或Fortran等低级语言编写的代码。
dtype数值以相同方式命名：一个类型名如float或int，随后是一个表明每个元素占多少位的数字。标准双精度浮点数占8个字节或64位。
因此，这种类型在NumPy中被命名为float64。见表4-2 NumPy支持的数据类型全面清单。</p>
<p>注：不要担心记忆NumPy数据类型，尤其是你现在还是一个新手时。
仅仅有必要关心你正在处理的通用数据种类，是浮点数。复数、整型、布尔型还是一般的Python对象。
当你需要更多地控制在磁盘和内存中数据储存方式时，特别是大型数据集，最好知道你控制的储存类型。</p>
<a class="reference internal image-reference" href="../_images/Table_4-2_NumPy_data_types.png"><img alt="../_images/Table_4-2_NumPy_data_types.png" src="../_images/Table_4-2_NumPy_data_types.png" style="width: 800px;" /></a>
<p>你能显式转换或铸造(<strong>cast</strong>)一个数组从一种dtype到另一种，使用ndarray的adtype方法:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">37</span><span class="p">]:</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">38</span><span class="p">]:</span> <span class="n">arr</span><span class="o">.</span><span class="n">dtype</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">38</span><span class="p">]:</span> <span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">39</span><span class="p">]:</span> <span class="n">float_arr</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">40</span><span class="p">]:</span> <span class="n">float_arr</span><span class="o">.</span><span class="n">dtype</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">40</span><span class="p">]:</span> <span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>在这个例子中，整型被转换成浮点型。
如果我转换一些浮点数字到一个整型dtype，小数部分将被丢弃:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">41</span><span class="p">]:</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">3.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">12.9</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">42</span><span class="p">]:</span> <span class="n">arr</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">42</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="mf">3.7</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">12.9</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">43</span><span class="p">]:</span> <span class="n">arr</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">43</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)</span>
</pre></div>
</div>
<p>如果你有代表数字的字符串数组，你可以使用astype转换它们到数值形式:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">44</span><span class="p">]:</span> <span class="n">numeric_strings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;1.25&#39;</span><span class="p">,</span> <span class="s1">&#39;-9.6&#39;</span><span class="p">,</span> <span class="s1">&#39;42&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">string_</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">45</span><span class="p">]:</span> <span class="n">numeric_strings</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">45</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="mf">1.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.6</span> <span class="p">,</span> <span class="mf">42.</span> <span class="p">])</span>
</pre></div>
</div>
<p>注意：谨慎使用numpy.string_type，因为string是固定大小，可能丢弃输入而没有警告。
pandas对非数字数据有更直观的开箱即用(<strong>out-of-the-box</strong>)行为。</p>
<p>如果由于一些原因（如字符串不能别转换成float64）转换失败，ValueError将抛出。
这儿我有点懒，写了float代替np.float64；NumPy将Python类型别名为其自己的等效数据类型。
你也可以使用另一种数组dtype属性:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">46</span><span class="p">]:</span> <span class="n">int_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">47</span><span class="p">]:</span> <span class="n">calibers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">.</span><span class="mi">22</span><span class="p">,</span> <span class="o">.</span><span class="mi">270</span><span class="p">,</span> <span class="o">.</span><span class="mi">357</span><span class="p">,</span> <span class="o">.</span><span class="mi">380</span><span class="p">,</span> <span class="o">.</span><span class="mi">44</span><span class="p">,</span> <span class="o">.</span><span class="mi">50</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">48</span><span class="p">]:</span> <span class="n">int_array</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">calibers</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">48</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">9.</span><span class="p">])</span>
</pre></div>
</div>
<p>有速记(<strong>shorthand</strong>)类型代码字符串，你可以指定一个dtype:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">49</span><span class="p">]:</span> <span class="n">empty_uint32</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;u4&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">50</span><span class="p">]:</span> <span class="n">empty_uint32</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">50</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1075314688</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1075707904</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
<span class="mi">1075838976</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1072693248</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">uint32</span><span class="p">)</span>
</pre></div>
</div>
<p>注：
调用astype一直会创建一个新数组（数据的一份拷贝），即使新dtype与老dtype相同。</p>
</div>
<div class="section" id="numpy-arithmetic">
<h2>使用NumPy数组进行算术运算(<strong>arithmetic</strong>)<a class="headerlink" href="#numpy-arithmetic" title="Permalink to this headline">¶</a></h2>
<p>数组是重要的因为它不需要使用for循环就可以表达数据的批量操作。
NumPy使用者称此为向量化。
任何在相同尺寸数组之间的算术操作都将操作应用到每个元素上:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">51</span><span class="p">]:</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">52</span><span class="p">]:</span> <span class="n">arr</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">52</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">53</span><span class="p">]:</span> <span class="n">arr</span> <span class="o">*</span> <span class="n">arr</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">53</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">9.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">16.</span><span class="p">,</span> <span class="mf">25.</span><span class="p">,</span> <span class="mf">36.</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">54</span><span class="p">]:</span> <span class="n">arr</span> <span class="o">-</span> <span class="n">arr</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">54</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>
</pre></div>
</div>
<p>与标量的算术操作将操作扩散(<strong>propagate</strong>)到数组中每个元素:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">55</span><span class="p">]:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">arr</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">55</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span> <span class="p">,</span> <span class="mf">0.5</span> <span class="p">,</span> <span class="mf">0.3333</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">0.25</span> <span class="p">,</span> <span class="mf">0.2</span> <span class="p">,</span> <span class="mf">0.1667</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">56</span><span class="p">]:</span> <span class="n">arr</span> <span class="o">**</span> <span class="mf">0.5</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">56</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span> <span class="p">,</span> <span class="mf">1.4142</span><span class="p">,</span> <span class="mf">1.7321</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">2.</span> <span class="p">,</span> <span class="mf">2.2361</span><span class="p">,</span> <span class="mf">2.4495</span><span class="p">]])</span>
</pre></div>
</div>
<p>相同大小之间的比较产生布尔数组:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">57</span><span class="p">]:</span> <span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">7.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">12.</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">58</span><span class="p">]:</span> <span class="n">arr2</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">58</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">7.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">12.</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">59</span><span class="p">]:</span> <span class="n">arr2</span> <span class="o">&gt;</span> <span class="n">arr</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">59</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
<span class="p">[</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</pre></div>
</div>
<p>在不同大小数组之间操作称之为广播(<strong>broadcasting</strong>)，将在附录A中详细讨论。本书的大部分不需要深入理解广播。</p>
</div>
<div class="section" id="id2">
<h2>基本索引和切片<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>NumPy数组索引是一个丰富的主题，因为有许多方法可以从你的数据中选择子集或单个元素。
一维数组很简单，表面上看与Python列表操作相似:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">60</span><span class="p">]:</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">61</span><span class="p">]:</span> <span class="n">arr</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">61</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">62</span><span class="p">]:</span> <span class="n">arr</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">62</span><span class="p">]:</span> <span class="mi">5</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">63</span><span class="p">]:</span> <span class="n">arr</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">63</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">64</span><span class="p">]:</span> <span class="n">arr</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">65</span><span class="p">]:</span> <span class="n">arr</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">65</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<p>如你看到的，你可以给切片赋一个标量值，像在arr[5:8] = 12，值被扩散到整个选中区域。
与Python列表一个重要的区别是数组切片是原始数组视图。
这意味着数据没有拷贝，任何对视图的修改将反映到源数组中。</p>
<p>给一个这样的例子，我首先创建arr的一个切片:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">66</span><span class="p">]:</span> <span class="n">arr_slice</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">67</span><span class="p">]:</span> <span class="n">arr_slice</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">67</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>
</pre></div>
</div>
<p>现在当我改变arr_slice值，变化(<strong>mutation</strong>)反映到原始数组arr中:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">68</span><span class="p">]:</span> <span class="n">arr_slice</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12345</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">69</span><span class="p">]:</span> <span class="n">arr</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">69</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12345</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
<span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<p>“光秃秃”的切片将给一个数组中所有元素赋值:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">70</span><span class="p">]:</span> <span class="n">arr_slice</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">64</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">71</span><span class="p">]:</span> <span class="n">arr</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">71</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<p>如果你是NumPy新手，你可能对此感到惊讶，尤其如果你使用过其它编程语言，拷贝数据很常见。
由于NumPy被设计处理很大的数组，如果NumPy坚持一直拷贝数据，你可以想象到性能和内存问题。</p>
<p>注意：
如果你想要ndarray切片的一个拷贝而不是试图，你需要显示拷贝数组-例如，arr[5:8].copy()。</p>
<p>处理更高维数组，你有更多选项。
在二维数组中，每个索引元素不再是标量而是一维数组:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">72</span><span class="p">]:</span> <span class="n">arr2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">73</span><span class="p">]:</span> <span class="n">arr2d</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">73</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<p>单个元素可以递归访问。
但是那样要做更多工作，你能传递一个逗号分隔的索引列表来选择单个元素。
它们有相同的效果:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">74</span><span class="p">]:</span> <span class="n">arr2d</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">74</span><span class="p">]:</span> <span class="mi">3</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">75</span><span class="p">]:</span> <span class="n">arr2d</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">75</span><span class="p">]:</span> <span class="mi">3</span>
</pre></div>
</div>
<p>见图4-1二维数组索引说明。
我发现将轴0想成”行”轴1想成”列”是有帮助的。</p>
<a class="reference internal image-reference" href="../_images/Figure_4-1_Indexing_elements_in_a_NumPy_array.png"><img alt="../_images/Figure_4-1_Indexing_elements_in_a_NumPy_array.png" src="../_images/Figure_4-1_Indexing_elements_in_a_NumPy_array.png" style="width: 800px;" /></a>
<p>在多维数组中，如果你省略后面的索引，返回的对象将是包含沿更高维全部数据的更低维ndarray。
所以在2x2x3数组arr3d:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">76</span><span class="p">]:</span> <span class="n">arr3d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">77</span><span class="p">]:</span> <span class="n">arr3d</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">77</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="p">[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span>
<span class="p">[[</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
<span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]]])</span>

<span class="n">arr3d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="n">是2x3数组</span><span class="p">::</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">78</span><span class="p">]:</span> <span class="n">arr3d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">78</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</pre></div>
</div>
<p>标量或数组都可以赋给arr3d[0]:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">79</span><span class="p">]:</span> <span class="n">old_values</span> <span class="o">=</span> <span class="n">arr3d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">80</span><span class="p">]:</span> <span class="n">arr3d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">42</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">81</span><span class="p">]:</span> <span class="n">arr3d</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">81</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">42</span><span class="p">],</span>
<span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">42</span><span class="p">]],</span>
<span class="p">[[</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
<span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">82</span><span class="p">]:</span> <span class="n">arr3d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">old_values</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">83</span><span class="p">]:</span> <span class="n">arr3d</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">83</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="p">[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span>
<span class="p">[[</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
<span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]]])</span>
</pre></div>
</div>
<p>类似地，arr3d[1, 0]给你索引从(1, 0)开始的所有值，形成一个1维数组:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">84</span><span class="p">]:</span> <span class="n">arr3d</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">84</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<p>这个表达式得到的结果与上面的相同，虽然我们索引了两步:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">85</span><span class="p">]:</span> <span class="n">x</span> <span class="o">=</span> <span class="n">arr3d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">86</span><span class="p">]:</span> <span class="n">x</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">86</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
<span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">87</span><span class="p">]:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">87</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<p>注意上面全部例子里，数组被选中的子集返回数组都是视图。</p>
<div class="section" id="id3">
<h3>使用切片进行索引<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>一维对象像Python列表，ndarray使用相似的语法切片:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">88</span><span class="p">]:</span> <span class="n">arr</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">88</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">89</span><span class="p">]:</span> <span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">89</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">64</span><span class="p">])</span>
</pre></div>
</div>
<p>考虑之前的二维数组，arr2d。切片这个数组有点不同:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">90</span><span class="p">]:</span> <span class="n">arr2d</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">90</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">91</span><span class="p">]:</span> <span class="n">arr2d</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">91</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</pre></div>
</div>
<p>正如你看到的，它沿着轴0，第一个轴切片。
切片，沿着某个轴选择一定范围的元素。看表达式arr2d[:2]作为”选择arr2d的前两行”是有帮助的。</p>
<p>你能传递多个切片就像你可以传递多个索引一样:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">92</span><span class="p">]:</span> <span class="n">arr2d</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">92</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</pre></div>
</div>
<p>像这样切片，你可以获得相同维度的数组视图。
通过混合整型索引和切片，你可以得到更低维度切片。</p>
<p>例如，我能选择第二行但是仅仅前两列，像这样:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">93</span><span class="p">]:</span> <span class="n">arr2d</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">93</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<p>类似地，我能选择第三列但是仅仅前两行，像这样:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">94</span><span class="p">]:</span> <span class="n">arr2d</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">94</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
<p>见图4-2的说明。
注意逗号本身意味着对全部轴操作，所以你可以仅仅在更高维轴通过这样切片:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">95</span><span class="p">]:</span> <span class="n">arr2d</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">1</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">95</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span>
<span class="p">[</span><span class="mi">4</span><span class="p">],</span>
<span class="p">[</span><span class="mi">7</span><span class="p">]])</span>
</pre></div>
</div>
<p>当然，赋值给一个切片表达式等于赋值给整个选中内容:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">96</span><span class="p">]:</span> <span class="n">arr2d</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">97</span><span class="p">]:</span> <span class="n">arr2d</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">97</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/Figure_4-2_Two-dimensional_array_slicing.png"><img alt="../_images/Figure_4-2_Two-dimensional_array_slicing.png" src="../_images/Figure_4-2_Two-dimensional_array_slicing.png" style="width: 800px;" /></a>
</div>
</div>
<div class="section" id="id4">
<h2>布尔索引<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>让我们考虑一个例子，我们有一些数据在数组中，数组中有重复的名字。
这里我将使用numpy.random中randn函数来生成一些随机正态(normally)分布数据:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">98</span><span class="p">]:</span> <span class="n">names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Joe&#39;</span><span class="p">,</span> <span class="s1">&#39;Will&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Will&#39;</span><span class="p">,</span> <span class="s1">&#39;Joe&#39;</span><span class="p">,</span> <span class="s1">&#39;Joe&#39;</span><span class="p">])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">99</span><span class="p">]:</span> <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">100</span><span class="p">]:</span> <span class="n">names</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">100</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Joe&#39;</span><span class="p">,</span> <span class="s1">&#39;Will&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Will&#39;</span><span class="p">,</span> <span class="s1">&#39;Joe&#39;</span><span class="p">,</span> <span class="s1">&#39;Joe&#39;</span><span class="p">],</span>
<span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U4&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">101</span><span class="p">]:</span> <span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">101</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.0929</span><span class="p">,</span> <span class="mf">0.2817</span><span class="p">,</span> <span class="mf">0.769</span> <span class="p">,</span> <span class="mf">1.2464</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">1.0072</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2962</span><span class="p">,</span> <span class="mf">0.275</span> <span class="p">,</span> <span class="mf">0.2289</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">1.3529</span><span class="p">,</span> <span class="mf">0.8864</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0016</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3718</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">1.669</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.4386</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5397</span><span class="p">,</span> <span class="mf">0.477</span> <span class="p">],</span>
<span class="p">[</span> <span class="mf">3.2489</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0212</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5771</span><span class="p">,</span> <span class="mf">0.1241</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">0.3026</span><span class="p">,</span> <span class="mf">0.5238</span><span class="p">,</span> <span class="mf">0.0009</span><span class="p">,</span> <span class="mf">1.3438</span><span class="p">],</span>
<span class="p">[</span><span class="o">-</span><span class="mf">0.7135</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8312</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.3702</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.8608</span><span class="p">]])</span>
</pre></div>
</div>
<p>假定每个名字对应data数组中每一行并且我们想要选中对应名字”Bob”的所有行。
像算术操作，数组的比较也被向量化了。
因此，比较names和字符串”Bob”产生一个布尔型数组:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">102</span><span class="p">]:</span> <span class="n">names</span> <span class="o">==</span> <span class="s1">&#39;Bob&#39;</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">102</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>

<span class="n">这个布尔数组可以被传递来索引数组</span><span class="p">::</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">103</span><span class="p">]:</span> <span class="n">data</span><span class="p">[</span><span class="n">names</span> <span class="o">==</span> <span class="s1">&#39;Bob&#39;</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">103</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.0929</span><span class="p">,</span> <span class="mf">0.2817</span><span class="p">,</span> <span class="mf">0.769</span> <span class="p">,</span> <span class="mf">1.2464</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">1.669</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.4386</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5397</span><span class="p">,</span> <span class="mf">0.477</span> <span class="p">]])</span>
</pre></div>
</div>
<p>布尔数组必须与它索引数组的轴相同长度。
你甚至可以混合和用索引或整型（或整型序列；稍后介绍）匹配布尔数组。</p>
<p>注意：
如果布尔数组长度不正确，布尔选择不会失败，所以建议小心使用这个特性。</p>
<p>在这些例子中，我选择names == ‘Bob’的行，也索引列:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">104</span><span class="p">]:</span> <span class="n">data</span><span class="p">[</span><span class="n">names</span> <span class="o">==</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">104</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.769</span> <span class="p">,</span> <span class="mf">1.2464</span><span class="p">],</span>
<span class="p">[</span><span class="o">-</span><span class="mf">0.5397</span><span class="p">,</span> <span class="mf">0.477</span> <span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">105</span><span class="p">]:</span> <span class="n">data</span><span class="p">[</span><span class="n">names</span> <span class="o">==</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">105</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="mf">1.2464</span><span class="p">,</span> <span class="mf">0.477</span> <span class="p">])</span>
</pre></div>
</div>
<p>要选中除了’Bob’的所有内容，你可以使用!=或使用~否定条件:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">106</span><span class="p">]:</span> <span class="n">names</span> <span class="o">!=</span> <span class="s1">&#39;Bob&#39;</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">106</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">107</span><span class="p">]:</span> <span class="n">data</span><span class="p">[</span><span class="o">~</span><span class="p">(</span><span class="n">names</span> <span class="o">==</span> <span class="s1">&#39;Bob&#39;</span><span class="p">)]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">107</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">1.0072</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2962</span><span class="p">,</span> <span class="mf">0.275</span> <span class="p">,</span> <span class="mf">0.2289</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">1.3529</span><span class="p">,</span> <span class="mf">0.8864</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0016</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3718</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">3.2489</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0212</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5771</span><span class="p">,</span> <span class="mf">0.1241</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">0.3026</span><span class="p">,</span> <span class="mf">0.5238</span><span class="p">,</span> <span class="mf">0.0009</span><span class="p">,</span> <span class="mf">1.3438</span><span class="p">],</span>
<span class="p">[</span><span class="o">-</span><span class="mf">0.7135</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8312</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.3702</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.8608</span><span class="p">]])</span>
</pre></div>
</div>
<p>~操作符是有用的当你想反向一个一般条件:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">108</span><span class="p">]:</span> <span class="n">cond</span> <span class="o">=</span> <span class="n">names</span> <span class="o">==</span> <span class="s1">&#39;Bob&#39;</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">109</span><span class="p">]:</span> <span class="n">data</span><span class="p">[</span><span class="o">~</span><span class="n">cond</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">109</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">1.0072</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2962</span><span class="p">,</span> <span class="mf">0.275</span> <span class="p">,</span> <span class="mf">0.2289</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">1.3529</span><span class="p">,</span> <span class="mf">0.8864</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0016</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3718</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">3.2489</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0212</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5771</span><span class="p">,</span> <span class="mf">0.1241</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">0.3026</span><span class="p">,</span> <span class="mf">0.5238</span><span class="p">,</span> <span class="mf">0.0009</span><span class="p">,</span> <span class="mf">1.3438</span><span class="p">],</span>
<span class="p">[</span><span class="o">-</span><span class="mf">0.7135</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8312</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.3702</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.8608</span><span class="p">]])</span>
</pre></div>
</div>
<p>结合多个布尔条件选中三个名字中的两个，使用布尔算术操作符像 &amp;(且) 和 !(或):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">110</span><span class="p">]:</span> <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">names</span> <span class="o">==</span> <span class="s1">&#39;Bob&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">names</span> <span class="o">==</span> <span class="s1">&#39;Will&#39;</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">111</span><span class="p">]:</span> <span class="n">mask</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">111</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">112</span><span class="p">]:</span> <span class="n">data</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">112</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.0929</span><span class="p">,</span> <span class="mf">0.2817</span><span class="p">,</span> <span class="mf">0.769</span> <span class="p">,</span> <span class="mf">1.2464</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">1.3529</span><span class="p">,</span> <span class="mf">0.8864</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0016</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3718</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">1.669</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.4386</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5397</span><span class="p">,</span> <span class="mf">0.477</span> <span class="p">],</span>
<span class="p">[</span> <span class="mf">3.2489</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0212</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5771</span><span class="p">,</span> <span class="mf">0.1241</span><span class="p">]])</span>
</pre></div>
</div>
<p>通过布尔索引从一个数组选择数据一直创建数据的一个副本，即使返回数组没有变化。</p>
<p>注意：
Python关键字and和or不能使用在布尔数组中，使用&amp;和|代替。</p>
<p>使用布尔数组设置值是显而易见的(<strong>common-sense</strong>, 尝试的)。
要设置data中所有负值为0，我们仅要做:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">113</span><span class="p">]:</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">114</span><span class="p">]:</span> <span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">114</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.0929</span><span class="p">,</span> <span class="mf">0.2817</span><span class="p">,</span> <span class="mf">0.769</span> <span class="p">,</span> <span class="mf">1.2464</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">1.0072</span><span class="p">,</span> <span class="mf">0.</span> <span class="p">,</span> <span class="mf">0.275</span> <span class="p">,</span> <span class="mf">0.2289</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">1.3529</span><span class="p">,</span> <span class="mf">0.8864</span><span class="p">,</span> <span class="mf">0.</span> <span class="p">,</span> <span class="mf">0.</span> <span class="p">],</span>
<span class="p">[</span> <span class="mf">1.669</span> <span class="p">,</span> <span class="mf">0.</span> <span class="p">,</span> <span class="mf">0.</span> <span class="p">,</span> <span class="mf">0.477</span> <span class="p">],</span>
<span class="p">[</span> <span class="mf">3.2489</span><span class="p">,</span> <span class="mf">0.</span> <span class="p">,</span> <span class="mf">0.</span> <span class="p">,</span> <span class="mf">0.1241</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">0.3026</span><span class="p">,</span> <span class="mf">0.5238</span><span class="p">,</span> <span class="mf">0.0009</span><span class="p">,</span> <span class="mf">1.3438</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">0.</span> <span class="p">,</span> <span class="mf">0.</span> <span class="p">,</span> <span class="mf">0.</span> <span class="p">,</span> <span class="mf">0.</span> <span class="p">]])</span>
</pre></div>
</div>
<p>使用一维布尔数组设置全部的行或列也很简单:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">115</span><span class="p">]:</span> <span class="n">data</span><span class="p">[</span><span class="n">names</span> <span class="o">!=</span> <span class="s1">&#39;Joe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">116</span><span class="p">]:</span> <span class="n">data</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">116</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">7.</span> <span class="p">,</span> <span class="mf">7.</span> <span class="p">,</span> <span class="mf">7.</span> <span class="p">,</span> <span class="mf">7.</span> <span class="p">],</span>
<span class="p">[</span> <span class="mf">1.0072</span><span class="p">,</span> <span class="mf">0.</span> <span class="p">,</span> <span class="mf">0.275</span> <span class="p">,</span> <span class="mf">0.2289</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">7.</span> <span class="p">,</span> <span class="mf">7.</span> <span class="p">,</span> <span class="mf">7.</span> <span class="p">,</span> <span class="mf">7.</span> <span class="p">],</span>
<span class="p">[</span> <span class="mf">7.</span> <span class="p">,</span> <span class="mf">7.</span> <span class="p">,</span> <span class="mf">7.</span> <span class="p">,</span> <span class="mf">7.</span> <span class="p">],</span>
<span class="p">[</span> <span class="mf">7.</span> <span class="p">,</span> <span class="mf">7.</span> <span class="p">,</span> <span class="mf">7.</span> <span class="p">,</span> <span class="mf">7.</span> <span class="p">],</span>
<span class="p">[</span> <span class="mf">0.3026</span><span class="p">,</span> <span class="mf">0.5238</span><span class="p">,</span> <span class="mf">0.0009</span><span class="p">,</span> <span class="mf">1.3438</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">0.</span> <span class="p">,</span> <span class="mf">0.</span> <span class="p">,</span> <span class="mf">0.</span> <span class="p">,</span> <span class="mf">0.</span> <span class="p">]])</span>
</pre></div>
</div>
<p>我们将在后面看到，这种类型操作在二维数组上使用pandas来做是很方便的。</p>
</div>
<div class="section" id="fancy-indexing">
<h2>花式索引(Fancy indexing)<a class="headerlink" href="#fancy-indexing" title="Permalink to this headline">¶</a></h2>
<p>Fancy indexing 是NumPy采用的术语来描述使用整型数组索引。
假设我们有一个8x4的数组:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">117</span><span class="p">]:</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">118</span><span class="p">]:</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
<span class="o">.....</span><span class="p">:</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">119</span><span class="p">]:</span> <span class="n">arr</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">119</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">6.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">7.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">,</span> <span class="mf">7.</span><span class="p">]])</span>
</pre></div>
</div>
<p>为了选出特定顺序行的子集，你可以简化传一个列表或整型的adarray指明想要的顺序:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">120</span><span class="p">]:</span> <span class="n">arr</span><span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">120</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">6.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">,</span> <span class="mf">6.</span><span class="p">]])</span>
</pre></div>
</div>
<p>希望这段代码符合您的预期！ 使用负索引从末端选择行:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">121</span><span class="p">]:</span> <span class="n">arr</span><span class="p">[[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">]]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">121</span><span class="p">]:</span>

<span class="n">array</span><span class="p">([[</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">5.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
</pre></div>
</div>
<p>传递多个索引数组有点不同；它选择一个一维数组元素对应于每个元组索引:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">122</span><span class="p">]:</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">123</span><span class="p">]:</span> <span class="n">arr</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">123</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="p">[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="p">[</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
<span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
<span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span>
<span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">],</span>
<span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">],</span>
<span class="p">[</span><span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">124</span><span class="p">]:</span> <span class="n">arr</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">124</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
<p>我们将在附录A中看到reshape方法的细节。</p>
<p>这里选择了元素(1, 0), (5, 3), (7, 1)和(2, 2)。
无论数组有多少维度（这里只有2），花式索引的结果总是一维的。</p>
<p>这种情况下花式索引与一些使用者（包括我自己）期待的有点不同，通过选择矩阵行列的子集形成一个矩形区域。
这儿是得到的矩形区域的一种方式:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">125</span><span class="p">]:</span> <span class="n">arr</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">]][:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">125</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">],</span>
<span class="p">[</span><span class="mi">28</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
<span class="p">[</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span>
</pre></div>
</div>
<p>记住，不像切片，花式索引一直拷贝数据到一个新的数组中。</p>
</div>
<div class="section" id="id5">
<h2>数组转置和交换轴<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>转置是一种特殊形式的重塑，相似地返回数据的**视图**而没有拷贝任何东西。数组有transpose方法也有特殊的T属性:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">126</span><span class="p">]:</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">127</span><span class="p">]:</span> <span class="n">arr</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">127</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="p">[</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
<span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">128</span><span class="p">]:</span> <span class="n">arr</span><span class="o">.</span><span class="n">T</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">128</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
<span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
<span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
<span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>
<span class="p">[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">14</span><span class="p">]])</span>
</pre></div>
</div>
<p>你可能经常要做矩阵计算-例如，当使用np.dot计算矩阵内积结果时:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">129</span><span class="p">]:</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">130</span><span class="p">]:</span> <span class="n">arr</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">130</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.8608</span><span class="p">,</span> <span class="mf">0.5601</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2659</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">0.1198</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0635</span><span class="p">,</span> <span class="mf">0.3329</span><span class="p">],</span>
<span class="p">[</span><span class="o">-</span><span class="mf">2.3594</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1995</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.542</span> <span class="p">],</span>
<span class="p">[</span><span class="o">-</span><span class="mf">0.9707</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.307</span> <span class="p">,</span> <span class="mf">0.2863</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">0.378</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.7539</span><span class="p">,</span> <span class="mf">0.3313</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">1.3497</span><span class="p">,</span> <span class="mf">0.0699</span><span class="p">,</span> <span class="mf">0.2467</span><span class="p">]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">131</span><span class="p">]:</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">131</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">9.2291</span><span class="p">,</span> <span class="mf">0.9394</span><span class="p">,</span> <span class="mf">4.948</span> <span class="p">],</span>
<span class="p">[</span> <span class="mf">0.9394</span><span class="p">,</span> <span class="mf">3.7662</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.3622</span><span class="p">],</span>
<span class="p">[</span> <span class="mf">4.948</span> <span class="p">,</span> <span class="o">-</span><span class="mf">1.3622</span><span class="p">,</span> <span class="mf">4.3437</span><span class="p">]])</span>
</pre></div>
</div>
<p>对于更高维度的数组，转置将接受轴编号的元组来置换轴（for extra mind bending，这句话没理解）:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">132</span><span class="p">]:</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">133</span><span class="p">]:</span> <span class="n">arr</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">133</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="p">[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]],</span>
<span class="p">[[</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
<span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">134</span><span class="p">]:</span> <span class="n">arr</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">134</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="p">[</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]],</span>
<span class="p">[[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]]])</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">将0轴和1轴交换意思是新的arr[0][1][0]是原来的arr[1][0][0], 新的arr[0][1][1]是原来的arr[1][0][1]。
转置操作有点抽象。</p>
</div>
<p>这儿，轴被重排，第二个轴变成第一个轴，第一个轴变成第二个，最后一个轴没有改变。</p>
<p>.T简单转置是交换轴的特殊情况。ndarray有swapaxes方法，它接受一对轴号并切换指示的轴以重新排列数据:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">135</span><span class="p">]:</span> <span class="n">arr</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">135</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="p">[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]],</span>
<span class="p">[[</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
<span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]]])</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">136</span><span class="p">]:</span> <span class="n">arr</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">136</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">]],</span>
<span class="p">[[</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
<span class="p">[</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>
<span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
<span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">15</span><span class="p">]]])</span>
</pre></div>
</div>
<p>swapaxes类似返回数据视图没有拷贝。</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="p02_Universal_Functions_Fast_Element-Wise_Array_Functions.html" class="btn btn-neutral float-right" title="4.2 通用函数：快速逐元素(element-wise)数组函数" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../chapters/p04_numpy_basics_arrays_and_vectorized_computation.html" class="btn btn-neutral" title="第四章：numpy基础：数组和向量化计算" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, gfjiang.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1.0',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>